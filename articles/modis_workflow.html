<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Moderate Resolution Imaging Spectroradiometer (MODIS) • amadeus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Moderate Resolution Imaging Spectroradiometer (MODIS)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">amadeus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/download_functions.html">download_data Function</a></li>
    <li><a class="dropdown-item" href="../articles/protected_datasets.html">Protected Datasets</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Source-Specific Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/terraclimate_workflow.html">Climatology Lab TerraClimate</a></li>
    <li><a class="dropdown-item" href="../articles/gridmet_workflow.html">Climatology Lab GridMET</a></li>
    <li><a class="dropdown-item" href="../articles/modis_workflow.html">NASA Moderate Resolution Imaging Spectroradiometer (MODIS)</a></li>
    <li><a class="dropdown-item" href="../articles/narr_workflow.html">North American Regional Reanalysis (NARR)</a></li>
    <li><a class="dropdown-item" href="../articles/epa_download.html">US EPA Air Quality System (AQS)</a></li>
  </ul>
</li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NIEHS/amadeus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Moderate Resolution Imaging Spectroradiometer (MODIS)</h1>
                        <h4 data-toc-skip class="author">Mitchell
Manware</h4>
            
            <h4 data-toc-skip class="date">2025-08-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NIEHS/amadeus/blob/main/vignettes/modis_workflow.Rmd" class="external-link"><code>vignettes/modis_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>modis_workflow.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to download, process, and calculate
covariates from the NASA’s Moderate Resolution Imaging Spectroradiometer
(MODIS) products using <code>amadeus</code> functions. Examples are
provided for the <code>MOD11A1</code> (land surface temperature),
<code>MOD06_L2</code> (clouds 5-m L2 swath), and <code>VNP46A2</code>
(VIIRS nightime lights) products. The messages returned by
<code>amadeus</code> functions have been omitted for brevity.</p>
<div class="section level3">
<h3 id="modis-grids">MODIS Grids<a class="anchor" aria-label="anchor" href="#modis-grids"></a>
</h3>
<p>MODIS product data files are separated based on tile grid numbers. To
download data for a specific geographic area, users must first identify
which tile grids correspond to the area of interest. The area of
interest for these vignettes will be the contiguous United States,
corresponding to horizontal tiles 7 to 13 and vertical tiles 3 to 6. See
<a href="https://modis-land.gsfc.nasa.gov/MODLAND_grid.html" class="external-link">MODIS
Grids</a> for further details.</p>
</div>
<div class="section level3">
<h3 id="nasa-earthdata-token">NASA Earthdata Token<a class="anchor" aria-label="anchor" href="#nasa-earthdata-token"></a>
</h3>
<p>To download NASA MODIS files, users must first register for a NASA
EarthData account and generate a user-specific token. For instructions,
see the <a href="https://niehs.github.io/amadeus/articles/protected_datasets.html">Protected
Data Sources</a> vignette.</p>
</div>
<div class="section level3">
<h3 id="mod11a1---land-surface-temperature">MOD11A1 - Land Surface Temperature<a class="anchor" aria-label="anchor" href="#mod11a1---land-surface-temperature"></a>
</h3>
<p>The <a href="https://www.earthdata.nasa.gov/data/catalog/lpcloud-mod11a1-061" class="external-link">MOD11A1</a>
product provides daily, global land surface temperature (LST) estimates
at 1km resolution.</p>
<p>Downloaded data files are Hierarchical Data Format (HDF), with the
extension <code>.hdf</code></p>
<ul>
<li>
<code>dataset_name = "modis"</code>: MODIS dataset name.</li>
<li>
<code>version =  "61"</code>: Version 6.1 (most recent release as of
08/07/2025).</li>
<li>
<code>horizontal_tiles = c(7, 13)</code>: Horizontal sinusoidal
tiles.</li>
<li>
<code>vertical_tiles = c(3, 6)</code>: Vertical sinusoidal
tiles.</li>
<li>
<code>date = c("2019-09-01", "2019-09-02")</code>: Dates of
interest.</li>
<li>
<code>nasa_earth_data_token = Sys.getenv("EARTHDATA_TOKEN")</code>:
User-specific NASA credentials.</li>
<li>
<code>directory_to_save = dir</code>: directory to save the
downloaded files.</li>
<li>
<code>acknowledgement = TRUE</code>: acknowledge that the raw data
files are large and may consume lots of local storage.</li>
<li>
<code>download = TRUE</code>: download the data files.</li>
<li>
<code>remove_command = TRUE</code>: remove the temporary command
file used to download the data.</li>
<li>
<code>hash = TRUE</code>: generate unique SHA-1 hash for the
downloaded files.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"modis"</span><span class="op">)</span></span>
<span><span class="fu">amadeus</span><span class="fu">::</span><span class="fu"><a href="../reference/download_data.html">download_data</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"modis"</span>,</span>
<span>  product <span class="op">=</span> <span class="st">"MOD11A1"</span>,</span>
<span>  horizontal_tiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>  vertical_tiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2019-08-15"</span>, <span class="st">"2019-08-16"</span><span class="op">)</span>,</span>
<span>  nasa_earth_data_token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"EARTHDATA_TOKEN"</span><span class="op">)</span>,</span>
<span>  directory_to_save <span class="op">=</span> <span class="va">dir</span>,</span>
<span>  acknowledge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  download <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_command <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hash <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>2 / 2 days of data available in the queried dates.

Downloading requested files...

[`wget` DOWNLOAD OUTPUT OMITTED]

Requested files have been downloaded.

Requests were processed.

[1] "bbbd6812cf686d9dac059a6aab27293d"</code></pre>
<p>Check that the downloaded files correspond to the requested tiles and
dates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "2019/244/MOD11A1.A2019244.h07v03.061.2020359040222.hdf"
 [2] "2019/244/MOD11A1.A2019244.h07v05.061.2020359040223.hdf"
 [3] "2019/244/MOD11A1.A2019244.h07v06.061.2020359040210.hdf"
 [4] "2019/244/MOD11A1.A2019244.h08v03.061.2020359040215.hdf"
 [5] "2019/244/MOD11A1.A2019244.h08v04.061.2020359040147.hdf"
 [6] "2019/244/MOD11A1.A2019244.h08v05.061.2020359040228.hdf"
 [7] "2019/244/MOD11A1.A2019244.h08v06.061.2020359040221.hdf"
 [8] "2019/244/MOD11A1.A2019244.h09v03.061.2020359040130.hdf"
 [9] "2019/244/MOD11A1.A2019244.h09v04.061.2020359040211.hdf"
[10] "2019/244/MOD11A1.A2019244.h09v05.061.2020359040208.hdf"
[11] "2019/244/MOD11A1.A2019244.h09v06.061.2020359040116.hdf"
[12] "2019/244/MOD11A1.A2019244.h10v03.061.2020359040202.hdf"
[13] "2019/244/MOD11A1.A2019244.h10v04.061.2020359040203.hdf"
[14] "2019/244/MOD11A1.A2019244.h10v05.061.2020359040223.hdf"
[15] "2019/244/MOD11A1.A2019244.h10v06.061.2020359040146.hdf"
[16] "2019/244/MOD11A1.A2019244.h11v03.061.2020359040221.hdf"
[17] "2019/244/MOD11A1.A2019244.h11v04.061.2020359040244.hdf"
[18] "2019/244/MOD11A1.A2019244.h11v05.061.2020359040135.hdf"
[19] "2019/244/MOD11A1.A2019244.h11v06.061.2020359040057.hdf"
[20] "2019/244/MOD11A1.A2019244.h12v03.061.2020359040138.hdf"
[21] "2019/244/MOD11A1.A2019244.h12v04.061.2020359040148.hdf"
[22] "2019/244/MOD11A1.A2019244.h12v05.061.2020359040131.hdf"
[23] "2019/244/MOD11A1.A2019244.h13v03.061.2020359040116.hdf"
[24] "2019/244/MOD11A1.A2019244.h13v04.061.2020359040145.hdf"
[25] "2019/245/MOD11A1.A2019245.h07v03.061.2020359055441.hdf"
[26] "2019/245/MOD11A1.A2019245.h07v05.061.2020359055458.hdf"
[27] "2019/245/MOD11A1.A2019245.h07v06.061.2020359055458.hdf"
[28] "2019/245/MOD11A1.A2019245.h08v03.061.2020359055537.hdf"
[29] "2019/245/MOD11A1.A2019245.h08v04.061.2020359055634.hdf"
[30] "2019/245/MOD11A1.A2019245.h08v05.061.2020359055658.hdf"
[31] "2019/245/MOD11A1.A2019245.h08v06.061.2020359055704.hdf"
[32] "2019/245/MOD11A1.A2019245.h09v03.061.2020359055648.hdf"
[33] "2019/245/MOD11A1.A2019245.h09v04.061.2020359055602.hdf"
[34] "2019/245/MOD11A1.A2019245.h09v05.061.2020359055715.hdf"
[35] "2019/245/MOD11A1.A2019245.h09v06.061.2020359055649.hdf"
[36] "2019/245/MOD11A1.A2019245.h10v03.061.2020359055611.hdf"
[37] "2019/245/MOD11A1.A2019245.h10v04.061.2020359055559.hdf"
[38] "2019/245/MOD11A1.A2019245.h10v05.061.2020359055531.hdf"
[39] "2019/245/MOD11A1.A2019245.h10v06.061.2020359055702.hdf"
[40] "2019/245/MOD11A1.A2019245.h11v03.061.2020359055542.hdf"
[41] "2019/245/MOD11A1.A2019245.h11v04.061.2020359055542.hdf"
[42] "2019/245/MOD11A1.A2019245.h11v05.061.2020359055613.hdf"
[43] "2019/245/MOD11A1.A2019245.h11v06.061.2020359055445.hdf"
[44] "2019/245/MOD11A1.A2019245.h12v03.061.2020359055532.hdf"
[45] "2019/245/MOD11A1.A2019245.h12v04.061.2020359055524.hdf"
[46] "2019/245/MOD11A1.A2019245.h12v05.061.2020359055454.hdf"
[47] "2019/245/MOD11A1.A2019245.h13v03.061.2020359055516.hdf"
[48] "2019/245/MOD11A1.A2019245.h13v04.061.2020359055521.hdf"</code></pre>
<p>Unlike other <code>amadeus</code>-supported datasets, <strong>users
do not need to directly call the <code>process_modis_merge</code>
function.</strong> This function is passed to the
<code>calculate_covariates</code> function based on the
<code>preprocess</code> parameter. Within
<code>calculate_covariates,</code> the <code>process_modis_merge</code>
function imports the downloaded files and merges them according to their
tile position.</p>
<p>Check the available layers from the product. The first file is used
to identify the available layers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/describe.html" class="external-link">describe</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  sds <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">var</span></span></code></pre></div>
<pre><code> [1] "LST_Day_1km"     "QC_Day"          "Day_view_time"   "Day_view_angl"
 [5] "LST_Night_1km"   "QC_Night"        "Night_view_time" "Night_view_angl"
 [9] "Emis_31"         "Emis_32"         "Clear_day_cov"   "Clear_night_cov"</code></pre>
<p>For the example, we are interested in the <code>LST_Day_1km</code>
variable for daytime land surface temperature.</p>
<p>Process, inspect, and plot the LST data from August 15, 2019.
<strong>Note</strong>, when calling <code>process_modis_merge</code>
directly, users can only process one day per function call.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rast_mod11a1</span> <span class="op">&lt;-</span> <span class="fu">amadeus</span><span class="fu">::</span><span class="fu"><a href="../reference/process_modis_merge.html">process_modis_merge</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"2019-08-15"</span>,</span>
<span>  subdataset <span class="op">=</span> <span class="st">"LST_Day_1km"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rast_mod11a1</span></span></code></pre></div>
<pre><code>class       : SpatRaster
size        : 4800, 8400, 1  (nrow, ncol, nlyr)
resolution  : 926.6254, 926.6254  (x, y)
extent      : -12231456, -4447802, 2223901, 6671703  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs
source(s)   : memory
varname     : MOD11A1.A2019244.h07v03.061.2020359040222
name        : LST_Day_1km
min value   :       12609
max value   :       16886</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rast_mod11a1</span><span class="op">$</span><span class="va">LST_Day_1km</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mod11a1.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p>As mentioned before, this processing is not part of the
<code>amadeus</code> workflow for MODIS products. To calculate
covariates for MODIS products, the preprocess function and layer
selections are passed as parameters to
<code>calculate_covariates</code>. The following code will calculate
mean LST for Connecticut’s counties for August 15 and 16, 2019.</p>
<ul>
<li>
<code>dataset_name = "modis"</code>: MODIS dataset name.</li>
<li>
<code>from = list.files(dir, full.names = TRUE, recursive = TRUE)</code>:
MOD11A1 file paths. The dates of data available in these file paths will
determine the dates in the output.</li>
<li>
<code>locs = tigris::counties("CT", year = 2019, cb = TRUE)</code>:
Connecticut county polygons.</li>
<li>
<code>locs_id = "NAME"</code>: Use <code>NAME</code> column for
unique county identifiers.</li>
<li>
<code>radius = 0L</code>: Apply 0m buffer to plygons.</li>
<li>
<code>preprocess = amadeus::process_modis_merge</code>: Preprocess
<code>.hdf</code> files with the merging function.</li>
<li>
<code>subdataset = "LST_Day_1km"</code>: Daytime LST variable
code.</li>
<li>
<code>name_covariates = "LST_"</code>: Prefix for column name for
calculated covariates.</li>
<li>
<code>fun_summary = "mean"</code>: Calculate <code>mean</code>
LST.</li>
<li>
<code>geom = FALSE</code>: Do not return with spatial geometries
(ie. return as <code>data.frame</code>).</li>
<li>
<code>scale = "* 0.02 - 273.15"</code>: Multiply values by 0.02 and
subtract 273.15.</li>
</ul>
<p>The <code>scale</code> parameter is crucial as it scales the values
stored in the <code>.hdf</code> files to the scientifically
interpretable values. The scale factor for each MODIS product can be
found in the technical documentation (also called User Guide). The scale
factor for MOD11A1 is 0.02 (see [<a href="https://lpdaac.usgs.gov/documents/715/MOD11_User_Guide_V61.pdf" class="external-link uri">https://lpdaac.usgs.gov/documents/715/MOD11_User_Guide_V61.pdf</a>]
Table 3. The SDSs in the MOD11_L2 product). This scale factor converts
the values to Kelvin, which are then converted to Celsius with the
additional <code>- 273.15</code> expression.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_mod11a1</span> <span class="op">&lt;-</span> <span class="fu">amadeus</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_covariates.html">calculate_covariates</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"modis"</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  locs <span class="op">=</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span><span class="st">"CT"</span>, year <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span>,</span>
<span>  locs_id <span class="op">=</span> <span class="st">"NAME"</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  preprocess <span class="op">=</span> <span class="fu">amadeus</span><span class="fu">::</span><span class="va"><a href="../reference/process_modis_merge.html">process_modis_merge</a></span>,</span>
<span>  subdataset <span class="op">=</span> <span class="st">"LST_Day_1km"</span>,</span>
<span>  name_covariates <span class="op">=</span> <span class="st">"LST_"</span>,</span>
<span>  fun_summary <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  geom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"* 0.02 - 273.15"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_mod11a1</span></span></code></pre></div>
<pre><code>         NAME LST_00000       time
1   Middlesex  28.06504 2019-08-15
2  New London  27.04361 2019-08-15
3   New Haven  28.30738 2019-08-15
4     Tolland  27.73284 2019-08-15
5    Hartford  28.19241 2019-08-15
6     Windham  26.81317 2019-08-15
7   Fairfield  27.98380 2019-08-15
8  Litchfield  26.95756 2019-08-15
9   Middlesex  24.12254 2019-08-16
10 New London  24.15377 2019-08-16
11  New Haven  25.04651 2019-08-16
12    Tolland  24.82655 2019-08-16
13   Hartford  26.15234 2019-08-16
14    Windham  22.61115 2019-08-16
15  Fairfield  24.45862 2019-08-16
16 Litchfield  24.06681 2019-08-16</code></pre>
<p>In the <code>data.frame</code>, mean LST values for each county are
calculated for August 15 and 16, 2019, the same dates originally passed
to <code>download_data</code>. The column containing the mean LST
variables is <code>LST_00000</code>, which reflects our manually set
<code>name_covariates = "LST_"</code> prefix <strong>and the buffer
radius (padded to 5 digits)</strong>. The <code>LST_00000</code> column
contains LST values in Celsius, per the <code>scale</code>
parameter.</p>
<p>If we were to calculate mean LST at the centroid of each Connecticut
county with a 100m buffer, the covariate column name would be
<code>LST_00100</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_mod11a1_centroids</span> <span class="op">&lt;-</span> <span class="fu">amadeus</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_covariates.html">calculate_covariates</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"modis"</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  locs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span> <span class="co"># centroids of each county</span></span>
<span>    <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span><span class="st">"CT"</span>, year <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  locs_id <span class="op">=</span> <span class="st">"NAME"</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">100L</span>, <span class="co"># 100 meter circular buffer</span></span>
<span>  preprocess <span class="op">=</span> <span class="fu">amadeus</span><span class="fu">::</span><span class="va"><a href="../reference/process_modis_merge.html">process_modis_merge</a></span>,</span>
<span>  subdataset <span class="op">=</span> <span class="st">"LST_Day_1km"</span>,</span>
<span>  name_covariates <span class="op">=</span> <span class="st">"LST_"</span>,</span>
<span>  fun_summary <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  geom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"* 0.02 - 273.15"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_mod11a1_centroids</span></span></code></pre></div>
<pre><code>         NAME LST_00100       time
1   Middlesex  26.19000 2019-08-15
2  New London  27.40616 2019-08-15
3   New Haven  32.71462 2019-08-15
4     Tolland  27.31000 2019-08-15
5    Hartford  32.75000 2019-08-15
6     Windham  26.47000 2019-08-15
7   Fairfield  28.18088 2019-08-15
8  Litchfield  22.83000 2019-08-15
9   Middlesex  23.51000 2019-08-16
10 New London  23.73023 2019-08-16
11  New Haven  28.45154 2019-08-16
12    Tolland  25.13000 2019-08-16
13   Hartford  29.47000 2019-08-16
14    Windham  24.43000 2019-08-16
15  Fairfield  22.41000 2019-08-16
16 Litchfield  21.07516 2019-08-16</code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mitchell Manware, Insang Song, Eva Marques, Mariana Alifa Kassien, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
